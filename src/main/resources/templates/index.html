<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Artistic Gallery</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-up': 'slideUp 0.5s ease-out',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' }
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' }
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .image-card {
            transition: all 0.3s ease;
            background: linear-gradient(145deg, #ffffff, #f8fafc);
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .image-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .artistic-filter {
            filter: brightness(1.05) contrast(1.1) saturate(1.1);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-50 to-blue-100 min-h-screen">
<!-- Header -->
<header class="bg-white/80 backdrop-blur-lg shadow-sm sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center py-6">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 bg-gradient-to-r from-purple-500 to-blue-500 rounded-full flex items-center justify-center">
                    <span class="text-white font-bold text-lg">üé®</span>
                </div>
                <h1 class="text-3xl font-bold bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent">
                    Artistic Gallery
                </h1>
            </div>
            <nav class="flex space-x-8 items-center">
                <a th:href="@{/}" class="text-gray-700 hover:text-purple-600 font-medium transition-colors">Gallery</a>
                <a th:href="@{/upload}" class="bg-gradient-to-r from-purple-500 to-blue-500 text-white px-6 py-2 rounded-full font-medium hover:from-purple-600 hover:to-blue-600 transition-all transform hover:scale-105">
                    Upload Image
                </a>
                <span class="text-sm text-gray-500" th:text="'Total: ' + ${imageCount} + ' images'"></span>
            </nav>
        </div>
    </div>
</header>

<!-- Flash Messages -->
<div th:if="${success != null or error != null}" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-4">
    <div th:if="${success != null}" class="bg-green-50 border border-green-200 rounded-xl p-4 mb-4 animate-fade-in">
        <div class="flex items-center">
            <span class="text-green-500 text-lg mr-2">‚úÖ</span>
            <p class="text-green-800 font-medium" th:text="${success}"></p>
        </div>
    </div>
    <div th:if="${error != null}" class="bg-red-50 border border-red-200 rounded-xl p-4 mb-4 animate-fade-in">
        <div class="flex items-center">
            <span class="text-red-500 text-lg mr-2">‚ùå</span>
            <p class="text-red-800 font-medium" th:text="${error}"></p>
        </div>
    </div>
</div>

<!-- Main Content -->
<main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <!-- Gallery Title -->
    <div class="text-center mb-12 animate-slide-up">
        <h2 class="text-5xl font-bold text-gray-900 mb-4">Visual Masterpieces</h2>
        <p class="text-xl text-gray-600 max-w-3xl mx-auto">
            Discover a curated collection of stunning images. Each picture tells a unique story.
        </p>
    </div>

    <!-- Gallery Grid -->
    <div th:if="${#lists.isEmpty(images)}" class="text-center py-20">
        <div class="max-w-md mx-auto">
            <div class="w-32 h-32 bg-gradient-to-r from-purple-200 to-blue-200 rounded-full mx-auto mb-6 flex items-center justify-center">
                <span class="text-4xl">üì∑</span>
            </div>
            <h3 class="text-2xl font-bold text-gray-700 mb-2">No images yet</h3>
            <p class="text-gray-500 mb-6">Be the first to upload a masterpiece!</p>
            <a th:href="@{/upload}" class="bg-gradient-to-r from-purple-500 to-blue-500 text-white px-8 py-3 rounded-full font-medium hover:from-purple-600 hover:to-blue-600 transition-all inline-block">
                Upload Your First Image
            </a>
        </div>
    </div>

    <div th:unless="${#lists.isEmpty(images)}" class="gallery-grid">
        <div th:each="image : ${images}" class="image-card group animate-fade-in">
            <div class="relative overflow-hidden rounded-2xl mb-4">
                <img th:src="@{'/images/' + ${image.id} + '/data'}"
                     th:alt="${image.description} ?: ${image.originalFilename}"
                     class="w-full h-64 object-cover artistic-filter group-hover:scale-110 transition-transform duration-500">
                <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end">
                    <div class="p-4 text-white">
                        <p class="font-semibold" th:text="${image.description} ?: 'No description'">Description</p>
                        <p class="text-sm opacity-90" th:text="${#temporals.format(image.uploadDate, 'MMM dd, yyyy HH:mm')}">Date</p>
                    </div>
                </div>
            </div>
            <div class="p-4">
                <h3 class="font-semibold text-gray-800 truncate" th:text="${image.originalFilename}">Filename</h3>
                <div class="flex justify-between items-center mt-2">
                    <span class="text-sm text-gray-500" th:text="${#numbers.formatDecimal(image.size/1024, 1, 0) + ' KB'}">Size</span>
                    <div class="flex space-x-2">
                        <a th:href="@{'/image/' + ${image.id}}"
                           class="text-blue-500 hover:text-blue-700 transition-colors text-sm font-medium">
                            View
                        </a>
                        <form th:action="@{'/delete/' + ${image.id}}" method="post" class="inline">
                            <button type="submit"
                                    onclick="return confirm('Are you sure you want to delete this image?')"
                                    class="text-red-500 hover:text-red-700 transition-colors text-sm font-medium">
                                Delete
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- Footer -->
<footer class="bg-white/50 mt-20 py-8 border-t border-gray-200">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <p class="text-gray-600">¬© 2024 Artistic Gallery. Powered by PostgreSQL</p>
    </div>
</footer>

<script>
    // Simple confirmation for delete actions
    document.addEventListener('DOMContentLoaded', function() {
        const deleteForms = document.querySelectorAll('form');
        deleteForms.forEach(form => {
            if (form.action.includes('/delete/')) {
                form.addEventListener('submit', function(e) {
                    if (!confirm('Are you sure you want to delete this image?')) {
                        e.preventDefault();
                    }
                });
            }
        });
    });
</script>
</body>
</html>