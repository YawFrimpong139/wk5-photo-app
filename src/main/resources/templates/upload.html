<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload Image - Artistic Gallery</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-up': 'slideUp 0.5s ease-out',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' }
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' }
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .animate-fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        .animate-slide-up {
            animation: slideUp 0.5s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-50 to-blue-100 min-h-screen">
<!-- Header -->
<header class="bg-white/80 backdrop-blur-lg shadow-sm">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center py-6">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 bg-gradient-to-r from-purple-500 to-blue-500 rounded-full flex items-center justify-center">
                    <span class="text-white font-bold text-lg">üé®</span>
                </div>
                <h1 class="text-3xl font-bold bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent">
                    Artistic Gallery
                </h1>
            </div>
            <nav class="flex space-x-8">
                <a th:href="@{/}" class="text-gray-700 hover:text-purple-600 font-medium transition-colors">Gallery</a>
                <a th:href="@{/upload}" class="bg-gradient-to-r from-purple-500 to-blue-500 text-white px-6 py-2 rounded-full font-medium hover:from-purple-600 hover:to-blue-600 transition-all transform hover:scale-105">
                    Upload Image
                </a>
            </nav>
        </div>
    </div>
</header>

<!-- Flash Messages -->
<div th:if="${success != null or error != null}" class="max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 mt-4">
    <div th:if="${success != null}" class="bg-green-50 border border-green-200 rounded-xl p-4 mb-4 animate-fade-in">
        <div class="flex items-center">
            <span class="text-green-500 text-lg mr-2">‚úÖ</span>
            <p class="text-green-800 font-medium" th:text="${success}"></p>
        </div>
    </div>
    <div th:if="${error != null}" class="bg-red-50 border border-red-200 rounded-xl p-4 mb-4 animate-fade-in">
        <div class="flex items-center">
            <span class="text-red-500 text-lg mr-2">‚ùå</span>
            <p class="text-red-800 font-medium" th:text="${error}"></p>
        </div>
    </div>
</div>

<!-- Main Content -->
<main class="max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <div class="bg-white/80 backdrop-blur-lg rounded-3xl shadow-xl p-8 animate-slide-up">
        <div class="text-center mb-8">
            <div class="w-20 h-20 bg-gradient-to-r from-purple-100 to-blue-100 rounded-full mx-auto mb-4 flex items-center justify-center">
                <span class="text-3xl">üì§</span>
            </div>
            <h2 class="text-4xl font-bold text-gray-900 mb-2">Share Your Art</h2>
            <p class="text-gray-600">Upload an image to showcase in our gallery</p>
        </div>

        <!-- Upload Form -->
        <form th:action="@{/upload}" method="post" enctype="multipart/form-data" class="space-y-6" id="uploadForm">
            <!-- File Upload -->
            <div class="space-y-2">
                <label class="block text-sm font-medium text-gray-700">Select Image</label>
                <div class="border-2 border-dashed border-gray-300 rounded-2xl p-8 text-center hover:border-purple-400 transition-colors group" id="fileUploadArea">
                    <input type="file" name="file" accept="image/*"
                           class="hidden" id="fileInput" required>
                    <label for="fileInput" class="cursor-pointer block">
                        <div class="w-16 h-16 bg-gradient-to-r from-purple-100 to-blue-100 rounded-full mx-auto mb-4 flex items-center justify-center group-hover:from-purple-200 group-hover:to-blue-200 transition-colors">
                            <span class="text-2xl">üñºÔ∏è</span>
                        </div>
                        <p class="text-gray-600 mb-2">Click to select an image</p>
                        <p class="text-sm text-gray-500">PNG, JPG, JPEG up to 10MB</p>
                    </label>
                </div>
                <!-- Preview goes here -->
                <div id="filePreview" class="mt-3"></div>
                <div id="fileError" class="text-red-500 text-sm mt-1 hidden">Please select an image file</div>
            </div>

            <!-- Description -->
            <div class="space-y-2">
                <label for="description" class="block text-sm font-medium text-gray-700">Image Description (Optional)</label>
                <textarea id="description" name="description"
                          class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all resize-none"
                          rows="3" placeholder="Tell us about this image... (optional)"></textarea>
            </div>

            <!-- Submit Button -->
            <button type="submit"
                    class="w-full bg-gradient-to-r from-purple-500 to-blue-500 text-white py-4 rounded-xl font-medium text-lg hover:from-purple-600 hover:to-blue-600 transition-all transform hover:scale-[1.02] active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed"
                    id="submitButton">
                Upload to Gallery
            </button>
        </form>

        <!-- Quick Actions -->
        <div class="mt-8 text-center">
            <a th:href="@{/}" class="text-purple-600 hover:text-purple-700 font-medium transition-colors inline-flex items-center">
                ‚Üê Back to Gallery
            </a>
        </div>
    </div>
</main>


<script>
    document.addEventListener('DOMContentLoaded', function() {
        const fileInput = document.getElementById('fileInput');
        const filePreview = document.getElementById('filePreview');
        const fileError = document.getElementById('fileError');
        const submitButton = document.getElementById('submitButton');
        const uploadForm = document.getElementById('uploadForm');

        // Reset preview
        function resetFilePreview() {
            filePreview.innerHTML = "";
            fileError.classList.add('hidden');
            submitButton.disabled = false;
            fileInput.value = ""; // reset actual input value
        }

        // Handle file selection
        fileInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) {
                resetFilePreview();
                return;
            }

            // Validate file type
            if (!file.type.startsWith('image/')) {
                fileError.textContent = 'Please select a valid image file (JPEG, PNG, GIF, etc.)';
                fileError.classList.remove('hidden');
                submitButton.disabled = true;
                return;
            }

            // Validate file size
            if (file.size > 10 * 1024 * 1024) {
                fileError.textContent = 'File size must be less than 10MB';
                fileError.classList.remove('hidden');
                submitButton.disabled = true;
                return;
            }

            // Show preview with thumbnail
            fileError.classList.add('hidden');
            submitButton.disabled = false;

            const reader = new FileReader();
            reader.onload = function(event) {
                filePreview.innerHTML = `
                <div class="flex items-center justify-between bg-gray-50 border rounded-lg p-3 mt-2">
                    <div class="flex items-center space-x-4">
                        <!-- Thumbnail -->
                        <img src="${event.target.result}" alt="preview"
                             class="w-16 h-16 object-cover rounded-lg border border-gray-300">

                        <div class="text-left">
                            <p class="font-medium text-gray-900">${file.name}</p>
                            <p class="text-sm text-gray-500">${(file.size / 1024 / 1024).toFixed(2)} MB</p>
                            <p class="text-xs text-gray-400">${file.type}</p>
                        </div>
                    </div>
                    <button type="button" onclick="(${resetFilePreview.toString()})();"
                            class="text-red-500 hover:text-red-700 font-bold">
                        ‚úï
                    </button>
                </div>
            `;
            };
            reader.readAsDataURL(file);
        });

        // Ensure form requires a file
        uploadForm.addEventListener('submit', function(e) {
            if (!fileInput.files || fileInput.files.length === 0) {
                e.preventDefault();
                fileError.textContent = 'Please select an image file';
                fileError.classList.remove('hidden');
            }
        });
    });
</script>



<!--<script>-->
<!--    document.addEventListener('DOMContentLoaded', function() {-->
<!--        const fileInput = document.getElementById('fileInput');-->
<!--        const fileUploadArea = document.getElementById('fileUploadArea');-->
<!--        const fileError = document.getElementById('fileError');-->
<!--        const submitButton = document.getElementById('submitButton');-->
<!--        const uploadForm = document.getElementById('uploadForm');-->

<!--        // Function to reset file input-->
<!--        window.resetFileInput = function() {-->
<!--            fileInput.value = '';-->
<!--            fileUploadArea.innerHTML = `-->
<!--                    <input type="file" name="file" accept="image/*"-->
<!--                           class="hidden" id="fileInput" required>-->
<!--                    <label for="fileInput" class="cursor-pointer block">-->
<!--                        <div class="w-16 h-16 bg-gradient-to-r from-purple-100 to-blue-100 rounded-full mx-auto mb-4 flex items-center justify-center group-hover:from-purple-200 group-hover:to-blue-200 transition-colors">-->
<!--                            <span class="text-2xl">üñºÔ∏è</span>-->
<!--                        </div>-->
<!--                        <p class="text-gray-600 mb-2">Click to select an image</p>-->
<!--                        <p class="text-sm text-gray-500">PNG, JPG, JPEG up to 10MB</p>-->
<!--                    </label>-->
<!--                `;-->
<!--            fileError.classList.add('hidden');-->
<!--            submitButton.disabled = false;-->

<!--            // Re-attach event listener to the new file input-->
<!--            const newFileInput = document.getElementById('fileInput');-->
<!--            newFileInput.addEventListener('change', handleFileSelect);-->
<!--        };-->

<!--        // File selection handler-->

<!--        -->
<!--        function handleFileSelect(e) {-->
<!--            const file = e.target.files[0];-->
<!--            if (file) {-->
<!--                // Validate file type-->
<!--                if (!file.type.startsWith('image/')) {-->
<!--                    fileError.textContent = 'Please select a valid image file (JPEG, PNG, GIF, etc.)';-->
<!--                    fileError.classList.remove('hidden');-->
<!--                    submitButton.disabled = true;-->
<!--                    return;-->
<!--                }-->

<!--                // Validate file size (client-side check)-->
<!--                if (file.size > 10 * 1024 * 1024) {-->
<!--                    fileError.textContent = 'File size must be less than 10MB';-->
<!--                    fileError.classList.remove('hidden');-->
<!--                    submitButton.disabled = true;-->
<!--                    return;-->
<!--                }-->

<!--                fileError.classList.add('hidden');-->
<!--                submitButton.disabled = false;-->

<!--                fileUploadArea.innerHTML = `-->
<!--                        <div class="flex items-center justify-center space-x-4">-->
<!--                            <div class="w-16 h-16 bg-gradient-to-r from-green-100 to-blue-100 rounded-full flex items-center justify-center">-->
<!--                                <span class="text-2xl">‚úÖ</span>-->
<!--                            </div>-->
<!--                            <div class="text-left">-->
<!--                                <p class="font-medium text-gray-900">${file.name}</p>-->
<!--                                <p class="text-sm text-gray-500">${(file.size / 1024 / 1024).toFixed(2)} MB</p>-->
<!--                                <p class="text-xs text-gray-400">${file.type}</p>-->
<!--                            </div>-->
<!--                            <button type="button" onclick="resetFileInput()" class="text-red-500 hover:text-red-700">-->
<!--                                ‚úï-->
<!--                            </button>-->
<!--                        </div>-->
<!--                    `;-->
<!--            }-->
<!--        }-->

<!--        // Attach event listener-->
<!--        fileInput.addEventListener('change', handleFileSelect);-->

<!--        // Form validation-->
<!--        uploadForm.addEventListener('submit', function(e) {-->
<!--            if (!fileInput.files || fileInput.files.length === 0) {-->
<!--                e.preventDefault();-->
<!--                fileError.textContent = 'Please select an image file';-->
<!--                fileError.classList.remove('hidden');-->
<!--            }-->
<!--        });-->
<!--    });-->
<!--</script>-->
</body>
</html>